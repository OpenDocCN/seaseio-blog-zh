<html>
<head>
<title>A Learning to Rank Project on a Daily Song Ranking Problem – Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每日歌曲排序问题的学习排序项目-第2部分</h1>
<blockquote>原文：<a href="https://web.archive.org/web/sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html#0001-01-01">https://web.archive.org/web/sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html#0001-01-01</a></blockquote>
									<section class="elementor-section elementor-top-section elementor-element elementor-element-18fae36 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="18fae36" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-f856cc4 ot-flex-column-vertical" data-id="f856cc4" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-f31445e elementor-widget elementor-widget-text-editor" data-id="f31445e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">如果你已经阅读了这篇博文的第1部分，你应该已经知道如何从可用的数据开始，使用开源库来建立一个学习排名(LTR)系统。</p>
<p class="translated">我们以未来工作的部分结束了这篇文章，其中我们提到了我们想要解决的三个方面。所以这篇博文分为三个主要部分:</p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated">在<strong>的第一部分</strong>中，我们对数据集进行采样，因为我们有兴趣发现，在拥有更少数据的情况下，我们是否仍然可以获得一个好的模型，从而获得与使用完整数据集进行训练类似(或更好)的结果。</li>
<li class="translated">在<strong>的第二部分</strong>，我们希望了解如果我们通过直接排序特定特征的值(在我们的例子中是降序)而不训练任何模型来对结果进行排序，会发生什么。</li>
<li class="translated">第三部分涉及通过使用库SHAP来解释模型的行为；特别是，我们将看到每个特性如何影响模型的输出。</li>
</ul>
</li>
</ul>
<p class="translated">【T8<!-- /wp:paragraph --><!-- wp:paragraph --><!-- /wp:paragraph --><!-- wp:list --><!-- /wp:list --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --></p>
<p class="has-text-align-justify translated">让我们一起，一个接一个地，来看看为解决上述问题而执行的3个不同实现所获得的结果。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-97fa735 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="97fa735" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-da4228e ot-flex-column-vertical" data-id="da4228e" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-50ace27 elementor-widget elementor-widget-iheading" data-id="50ace27" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h2 class="main-heading translated">1)如果在对我们的数据集进行采样之后，我们根据歌曲位置值来估计相关性标签，会发生什么？</h2>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-8b997be ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="8b997be" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-11a69aa ot-flex-column-vertical" data-id="11a69aa" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-e22654f elementor-widget elementor-widget-text-editor" data-id="e22654f" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">我们通过使用一个只从数据帧中过滤特定行的<a href="https://web.archive.org/web/20221202222543/https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/03_subset_data.html" target="_blank" rel="noreferrer noopener"> Pandas </a>函数，对我们的<strong>完整数据集</strong>进行了采样；特别是，我们感兴趣的是获得仅包含从位置1到21的每日歌曲图表的子集:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-2c4ea16 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="2c4ea16" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-2471f67 ot-flex-column-vertical" data-id="2471f67" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-c626c39 elementor-widget elementor-widget-text-editor" data-id="c626c39" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<div class="wp-block-group" style="box-sizing: border-box; color: #6d6d6d; font-family: 'Nunito Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">
<div class="wp-block-group__inner-container" style="box-sizing: border-box;">
<pre class="wp-block-code" style="box-sizing: border-box; overflow: auto; font-family: 'Courier 10 Pitch', Courier, monospace; font-size: 15px; background: #eeeeee; line-height: 1.71429; margin-bottom: 1.6em; max-width: 100%; padding: 1.6em;"><code style="box-sizing: border-box; font-family: inherit; font-size: 15px; display: block; overflow-wrap: break-word; white-space: pre-wrap;">subset = data_frame[data_frame["Position"] &lt;= 21]</code></pre>
</div>
</div>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-b278dea ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="b278dea" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-d438b4c ot-flex-column-vertical" data-id="d438b4c" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-ae0a599 elementor-widget elementor-widget-text-editor" data-id="ae0a599" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">我们得到了一个由412.385个观察值组成的<strong>子集</strong>，约占整个数据集的12%，它包含完全相同的数据结构(参见之前博客文章中解释的数据预处理和特征工程部分)。</p>
<p class="has-text-align-justify translated">我们已经直接从完整数据集的训练集和测试集中提取了训练集和测试集(80:20)(这是出于一般考虑中的第二个原因)。特征‘位置’(从1到21)用于估计相关性等级，我们的目标变量；因此，从0到20的相关性标签是通过以降序颠倒位置值来获得的。这样做是为了使图表上第一个位置(位置1)的歌曲具有最高的相关性标签(20)，而图表上最后一个位置(位置21)的歌曲具有最低的相关性标签(0)。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify translated">然后，我们使用为主要项目选择的相同算法和相关参数(在<a href="https://web.archive.org/web/20221202222543/https://sease.io/2020/12/a-learning-to-rank-project-on-a-daily-song-ranking-problem.html">第1部分</a>中描述)训练模型，并且我们使用相同的测试集评估模型的性能，以便在相同的“操场”上比较它们；获得的结果如下表所示:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-6b1486f ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="6b1486f" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-84bea29 ot-flex-column-vertical" data-id="84bea29" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-b3047ab elementor-widget elementor-widget-text-editor" data-id="b3047ab" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31783" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-09-55-21" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?fit=1068%2C558&amp;ssl=1" data-orig-size="1068,558" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 09.55.21" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?fit=300%2C157&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?fit=1024%2C535&amp;ssl=1" decoding="async" loading="lazy" width="1068" height="558" class="wp-image-31783 aligncenter" style="width: 450px;" src="../Images/46d9645a7c876e630e9b14f669608fab.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?w=1068&amp;ssl=1 1068w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?resize=300%2C157&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?resize=1024%2C535&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?resize=768%2C401&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?resize=720%2C376&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.55.21.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-4818497 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="4818497" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-ec38a05 ot-flex-column-vertical" data-id="ec38a05" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-95ea7f3 elementor-widget elementor-widget-iheading" data-id="95ea7f3" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h6 class="main-heading translated">一般注意事项:</h6>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-073e93e ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="073e93e" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-3258538 ot-flex-column-vertical" data-id="3258538" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-b598150 elementor-widget elementor-widget-text-editor" data-id="b598150" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<ol>
<li style="list-style-type: none;">
 
<ol>
<li class="translated">使用子集的模型训练明显更快</li>
<li class="translated">我们必须确保训练集和测试集之间没有交集；这意味着测试集的观测值在训练时必须是未知的</li>
<li class="translated">尽管数据较少，但使用子集构建的模型具有最佳性能；一个原因可能是整个数据集比子集具有更大的可变性</li>
<li class="translated">将Doc2Vec编码应用于音轨名称变量在整个数据集中似乎比在子集中更好</li>
<li class="translated">当我们使用较小的测试集时，我们得到了更好的结果，尽管没有实质性的差异。在这个领域中，子集的测试集的维度(大约84.000个观察值)已经给了我们足够的信息。通常，我们会想象测试集越大越好；实际上，存在一个阈值，超过这个阈值，增加测试集的维数不会带来任何好处。</li>
</ol>
</li>
</ol>
<p class="has-text-align-justify translated">我们还研究了为什么在使用Doc2Vec编码时，eval ndcg@10的值大于train ndcg@10(一般情况下应该相反)。这是一种罕见的现象，但它可能发生在任何ML模型上；有几个原因:</p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated">测试集大小可能太小</li>
<li class="translated">测试集由比训练集“更容易”的例子组成</li>
<li class="translated">在我们的数据集中没有太多的差异</li>
<li class="translated">我们的训练/测试分割适用于这种偶然行为</li>
</ul>
</li>
</ul>
<p class="translated"><!-- wp:list {"ordered":true} --> <!-- /wp:list --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:list --> <!-- /wp:list --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --></p>
<p class="has-text-align-justify translated">无论如何，在这种情况下，差异是无关紧要的，但如果这是一个非常大的差异，我们需要进一步调查。一个建议是尝试使用k-fold交叉验证，或者如果模型需要太多时间来训练，就在不同的混合训练/测试集上重新训练，以查看趋势是否持续。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-c8858a4 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="c8858a4" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-bc04e95 ot-flex-column-vertical" data-id="bc04e95" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-f961df1 elementor-widget elementor-widget-iheading" data-id="f961df1" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h2 class="main-heading translated">2)此外，如果我们直接使用流计数(降序)对结果进行排序，会有什么变化？我们会在搜索结果列表中得到相同的顺序吗(因此最大NDCG)？！</h2>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-5c04c3f ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="5c04c3f" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-fd7b7a0 ot-flex-column-vertical" data-id="fd7b7a0" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-0154a35 elementor-widget elementor-widget-text-editor" data-id="0154a35" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">为了找到这个问题的答案，我们使用了在数据预处理部分之后获得的完整数据集(具有从0到20的相关性标签)。</p>
<p class="translated"><span style="text-decoration: underline;"> <strong>请注意</strong>:在</span>下面的所有图像中，相关性标签由排名栏表示</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} -->T13<!-- wp:paragraph -->T15<!-- wp:paragraph {"align":"justify"} -->T17】</p>
<p class="has-text-align-justify translated">由于我们的目标是通过“流”计数对歌曲进行排序，因此查看一下<strong>相关矩阵</strong>是非常有用和有趣的，该表显示了变量之间的相关系数:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-02dcfd0 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="02dcfd0" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-8bce695 ot-flex-column-vertical" data-id="8bce695" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-5925f5a elementor-widget elementor-widget-text-editor" data-id="5925f5a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="27853" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/correlation_matrix_full_dataset" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?fit=2742%2C736&amp;ssl=1" data-orig-size="2742,736" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="correlation_matrix_full_dataset" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?fit=300%2C81&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?fit=1024%2C275&amp;ssl=1" decoding="async" loading="lazy" width="2742" height="736" class="wp-image-27853" style="width: 850px;" src="../Images/3b31a2584a6464dec6370ae69a18aa84.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?w=2742&amp;ssl=1 2742w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?resize=300%2C81&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?resize=1024%2C275&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?resize=768%2C206&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?resize=1536%2C412&amp;ssl=1 1536w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?resize=2048%2C550&amp;ssl=1 2048w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?resize=720%2C193&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/01/correlation_matrix_full_dataset.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-32406bc ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="32406bc" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-3787823 ot-flex-column-vertical" data-id="3787823" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-a239ef4 elementor-widget elementor-widget-text-editor" data-id="a239ef4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">我们可以看到，流与位置(-0.1339)、流与排名(0.1697)之间的相关性很低，而位置与艺人之间的相关性最高(0.4665)。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} -->T3】</p>
<p class="has-text-align-justify translated">我们根据'<strong>流</strong>'特性对整个数据集进行降序排序，通过下面的代码行按<strong> query_ID </strong>分组:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-0318976 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="0318976" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-6f31026 ot-flex-column-vertical" data-id="6f31026" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-c8ac8f4 elementor-widget elementor-widget-text-editor" data-id="c8ac8f4" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<pre class="wp-block-code" style="box-sizing: border-box; overflow: auto; font-family: 'Courier 10 Pitch', Courier, monospace; font-size: 15px; background: #eeeeee; line-height: 1.71429; margin-bottom: 1.6em; max-width: 100%; padding: 1.6em; color: #6d6d6d; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: inherit; font-size: 15px; display: block; overflow-wrap: break-word; white-space: pre-wrap;">data_frame_sorted = data_frame.groupby(["query_ID"]).apply(lambda x: x.sort_values(["Streams"], ascending=False)).reset_index(drop=True)</code></pre>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-7e85b38 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="7e85b38" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-4379c0e ot-flex-column-vertical" data-id="4379c0e" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-eb4abba elementor-widget elementor-widget-text-editor" data-id="eb4abba" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">一旦我们获得了有序数据集，我们就通过一部分代码手动计算NDCG@10，其中我们只对每个查询的搜索结果列表的前10首歌曲直接应用DCG公式及其归一化变体。在下面的示例中，您可以看到分别针对query_ID = 0和query_ID = 1返回的前10个结果。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-cc3f603 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="cc3f603" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-f70a758 ot-flex-column-vertical" data-id="f70a758" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-f3a70b9 elementor-widget elementor-widget-text-editor" data-id="f3a70b9" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31145" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-10-alle-12-51-29" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?fit=1056%2C704&amp;ssl=1" data-orig-size="1056,704" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-10 alle 12.51.29" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?fit=300%2C200&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?fit=1024%2C683&amp;ssl=1" decoding="async" loading="lazy" width="1056" height="704" class="wp-image-31145 aligncenter" style="width: 600px;" src="../Images/a6b87a4e64c49c4886a2d29c01535275.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?w=1056&amp;ssl=1 1056w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?resize=300%2C200&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?resize=1024%2C683&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?resize=768%2C512&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?resize=720%2C480&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-10-alle-12.51.29.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-e001b97 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="e001b97" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-b5e2f91 ot-flex-column-vertical" data-id="b5e2f91" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-2e928cf elementor-widget elementor-widget-text-editor" data-id="2e928cf" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">在排序后的数据集上，我们对“排名”列应用了以下步骤(针对每个查询):</p>
<div class="wp-block-group">
<p class="translated"><!-- wp:list --></p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated">算一下<strong>DCG @ 10</strong><a href="https://web.archive.org/web/20221202222543/https://machinelearningmedium.com/2017/07/24/discounted-cumulative-gain/" target="_blank" rel="noreferrer noopener">【1】</a></li>
</ul>
</li>
</ul>
<p class="translated"><!-- /wp:list --> <!-- wp:list --></p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated">计算出<strong>理想的DCG@10 </strong></li>
</ul>
</li>
</ul>
<p class="translated"><!-- /wp:list --> <!-- wp:list --></p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated">算算<strong> NDCG@10 </strong> <em> = DCG@10/理想的DCG@10 </em></li>
</ul>
</li>
</ul>
<p class="translated"><!-- /wp:list --> <!-- wp:list --></p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated"><strong>对所有查询的NDCG@10值进行平均</strong></li>
</ul>
</li>
</ul>
<p class="translated"><!-- /wp:list --></p>
</div>
<p class="translated">最终结果是<strong> NDCG@10 = 0.9347 </strong></p>
<p class="has-text-align-justify translated">在没有训练任何模型的情况下，我们通过直接使用流计数以降序对歌曲进行排序，获得了良好(以及更好)的NDCG。从上图可以看出，对于查询0，最大数据流都与图表顶部位置(排名20)的歌曲相关，而对于查询1，最大数据流与图表上的较高位置相关，但结果是分散的。</p>
<p class="translated"><!-- wp:paragraph --><!-- /wp:paragraph --><!-- wp:group --><!-- /wp:group --><!-- wp:paragraph --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify translated">此外，我们还注意到，对于一些查询(如查询0)，排序列表的第一个结果总是由不同日期的同一首歌曲(相同的<strong> ID </strong>表示。假设一个搜索引擎返回一系列相同的项目(相同的歌曲)是没有意义的。我们决定只保留每首歌曲和每个查询的最大数据流数量的观察值:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-5db61df ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="5db61df" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-010a93c ot-flex-column-vertical" data-id="010a93c" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-81005db elementor-widget elementor-widget-text-editor" data-id="81005db" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31137" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/maxstreams_sorted_0" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?fit=1370%2C452&amp;ssl=1" data-orig-size="1370,452" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="maxstreams_sorted_0" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?fit=300%2C99&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?fit=1024%2C338&amp;ssl=1" decoding="async" loading="lazy" width="1370" height="452" class="wp-image-31137 aligncenter" style="width: 600px;" src="../Images/5a935fabf35c55bb244d6f27bd9a37d9.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?w=1370&amp;ssl=1 1370w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?resize=300%2C99&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?resize=1024%2C338&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?resize=768%2C253&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?resize=720%2C238&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/maxstreams_sorted_0.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-a62cb29 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="a62cb29" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-7a8cf08 ot-flex-column-vertical" data-id="7a8cf08" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-18b7058 elementor-widget elementor-widget-text-editor" data-id="18b7058" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">再次按降序排序后(从上面关于查询0的图片中可以看到)，最终结果(所有查询的平均值)是<strong> NDCG@10 = 0.8212 </strong>。在这种情况下，删除一些观察值会使性能变差。</p>
<h6 class="translated"><span style="color: #333333;">子集</span></h6>
<p class="translated">我们使用子集而不是完整数据集重复了相同的实验，这些是观察到的结果:</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:heading {"level":4} --> <!-- /wp:heading --> <!-- wp:paragraph --> <!-- /wp:paragraph --> <!-- wp:list {"ordered":true,"textColor":"black"} --> <!-- /wp:list --></p>
<ol>
<li style="list-style-type: none;">
 
<ol>
<li class="translated">变量之间的相关性较小:<ul>
<li class="translated">位置和流之间的相关性为:<strong> -0.0810 </strong></li>
<li class="translated">排名和流之间的相关性是:<strong> 0.0810 </strong></li>
<li class="translated">位置与艺术家的相关性为:<strong> 0.1563 </strong></li>
</ul>
</li>
<li class="translated">相同的NDCG@10 ( <strong> 0.9347 </strong>)</li>
<li class="translated">NDCG@10略低(<strong> 0.8176 </strong>而不是<strong> 0.8212 </strong>)，此时我们只保留了每首歌曲的最大流的观察值。</li>
</ol>
</li>
</ol>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-fbd00a9 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="fbd00a9" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-311ff6e ot-flex-column-vertical" data-id="311ff6e" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-a4dcfcd elementor-widget elementor-widget-iheading" data-id="a4dcfcd" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h2 class="main-heading translated">3)通过使用库SHAP给出模型行为的解释，特别是每个特征如何影响模型的输出</h2>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-62eb342 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="62eb342" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-4bfd40f ot-flex-column-vertical" data-id="4bfd40f" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-7260fab elementor-widget elementor-widget-text-editor" data-id="7260fab" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">如果你错过了我们之前关于<a href="https://web.archive.org/web/20221202222543/https://sease.io/2020/07/explaining-learning-to-rank-models-with-tree-shap.html" target="_blank" rel="noreferrer noopener"> SHAP </a>的博文，请先阅读它，了解这个库的惊人工具，以及如何解释学习使用TreeSHAP算法对模型进行排序。</p>
<p class="has-text-align-justify translated">到目前为止，我们已经创建了一个数据集(完整)和一个子集，我们已经使用不同的数据预处理技术训练了几种类型的模型，现在我们想了解这些模型是如何实现这些结果的。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --></p>
<p class="has-text-align-justify translated">我们对4种不同的模型进行了比较:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-1598b4f ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="1598b4f" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-47e50c2 ot-flex-column-vertical" data-id="47e50c2" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-239340e elementor-widget elementor-widget-text-editor" data-id="239340e" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31446" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-12-alle-13-57-44" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-12-alle-13.57.44.png?fit=460%2C244&amp;ssl=1" data-orig-size="460,244" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-12 alle 13.57.44" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-12-alle-13.57.44.png?fit=300%2C159&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-12-alle-13.57.44.png?fit=460%2C244&amp;ssl=1" decoding="async" loading="lazy" width="460" height="244" class="wp-image-31446 aligncenter" style="width: 300px;" src="../Images/04da68d714931f190b4c96504d537811.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-12-alle-13.57.44.png?w=460&amp;ssl=1 460w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-12-alle-13.57.44.png?resize=300%2C159&amp;ssl=1 300w" sizes="(max-width: 460px) 100vw, 460px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-12-alle-13.57.44.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-36e1d7d ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="36e1d7d" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-352ac05 ot-flex-column-vertical" data-id="352ac05" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-2a535e5 elementor-widget elementor-widget-text-editor" data-id="2a535e5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">SHAP库<a href="https://web.archive.org/web/20221202222543/https://github.com/slundberg/shap" target="_blank" rel="noreferrer noopener">【2】</a>为每个预测创建模型解释，并描述如果从模型中移除特征<em> y </em>预测<em> x </em>如何变化。所谓的<strong> SHAP价值观</strong>就是答案。</p>
<p class="has-text-align-justify translated">由于我们使用LambdaMART(多重加性回归树)构建LTR模型，因此我们使用了<strong>tree explainer</strong><a href="https://web.archive.org/web/20221202222543/https://shap.readthedocs.io/en/latest/examples.html#tree-explainer" target="_blank" rel="noreferrer noopener">【3】</a>，这是一种在多项式时间内计算树和树集合的SHAP值的算法。</p>
<p class="has-text-align-justify translated">TreeSHAP为我们提供了几种不同类型的绘图，每一种都突出了模型的一个特定方面。Matplotlib ，一个非常有用的可视化库，用于Python中图形的渲染。</p>
<h6 class="translated">汇总图</h6>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:heading {"level":4} --><!-- /wp:heading --><!-- wp:paragraph {"align":"justify"} -->T11】</p>
<p class="has-text-align-justify translated">概要图给了我们<strong>全局可解释性</strong>。使用带有plot_type = " <strong> bar </strong>的<strong> shap.summary_plot </strong>函数，您可以用x轴上的平均值(|SHAP值|)生成特征重要性图(按降序排列的变量)。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-abf7acd ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="abf7acd" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-86dab7e ot-flex-column-vertical" data-id="86dab7e" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-f06a6bb elementor-widget elementor-widget-text-editor" data-id="f06a6bb" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31794" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-42-04" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?fit=1082%2C1132&amp;ssl=1" data-orig-size="1082,1132" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.42.04" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?fit=287%2C300&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?fit=979%2C1024&amp;ssl=1" decoding="async" loading="lazy" width="1082" height="1132" class="wp-image-31794 aligncenter" style="width: 550px;" src="../Images/b35802dc16442506746c4cb0a596b95f.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?w=1082&amp;ssl=1 1082w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?resize=287%2C300&amp;ssl=1 287w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?resize=979%2C1024&amp;ssl=1 979w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?resize=768%2C803&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?resize=720%2C753&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.04.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-6c8f269 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="6c8f269" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-471e6e0 ot-flex-column-vertical" data-id="471e6e0" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-1bc9bc6 elementor-widget elementor-widget-text-editor" data-id="1bc9bc6" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">我们可以看到，<em>流</em>功能实际上是最重要的，其次是<em>艺术家</em>功能。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} -->T8】</p>
<p class="has-text-align-justify translated">如果您想要显示预测值与目标变量的正负关系，您必须生成另一种类型的汇总图:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-a7168b3 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="a7168b3" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-22faca9 ot-flex-column-vertical" data-id="22faca9" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-9831a83 elementor-widget elementor-widget-text-editor" data-id="9831a83" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31795" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-42-24" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?fit=1084%2C1178&amp;ssl=1" data-orig-size="1084,1178" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.42.24" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?fit=276%2C300&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?fit=942%2C1024&amp;ssl=1" decoding="async" loading="lazy" width="1084" height="1178" class="wp-image-31795 aligncenter" style="width: 550px;" src="../Images/e601091d19f00fefe3549c11060dfb76.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?w=1084&amp;ssl=1 1084w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?resize=276%2C300&amp;ssl=1 276w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?resize=942%2C1024&amp;ssl=1 942w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?resize=768%2C835&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?resize=720%2C782&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.24.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-7c9f32b ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="7c9f32b" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-c22b0a0 ot-flex-column-vertical" data-id="c22b0a0" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-0fc2e16 elementor-widget elementor-widget-text-editor" data-id="0fc2e16" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">这些图不仅显示了可变的重要性(从上到下)，还显示了特征值(使用从蓝色到红色的色谱)如何影响标签预测；每个观察(歌曲)，每行都有一个点。</p>
<p class="has-text-align-justify translated">这里，流的数量越多，对相关性的正面影响就越高(SHAP值大于零)；而‘艺术家’特征与目标变量负相关。如果您还记得，Artists列是使用留一技术编码的，该技术用与该级别相关的目标变量值的平均值替换分类值，但在计算平均值时排除当前行的目标值；因此，这个数值本身并不重要，但是更有趣的是知道哪个艺术家对应于那个值，以了解谁是最受欢迎的。</p>
<p class="has-text-align-justify translated">其他特征的排序看起来有点不同，但是总体上我们可以说该子集足以代表整个数据集。</p>
<h6 class="translated">决策图</h6>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:heading {"level":4} --><!-- /wp:heading --><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --></p>
<p class="has-text-align-justify translated">决策图<a href="https://web.archive.org/web/20221202222543/https://slundberg.github.io/shap/notebooks/plots/decision_plot.html">【4】</a>展示了模型如何做出决策，显示了每个特征的累积效应。每条垂直线代表一个预测:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-f01c3c8 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="f01c3c8" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-b82d757 ot-flex-column-vertical" data-id="b82d757" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-4f84e80 elementor-widget elementor-widget-text-editor" data-id="4f84e80" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31796" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-41-42" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?fit=1080%2C1290&amp;ssl=1" data-orig-size="1080,1290" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.41.42" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?fit=251%2C300&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?fit=857%2C1024&amp;ssl=1" decoding="async" loading="lazy" width="1080" height="1290" class="wp-image-31796 aligncenter" style="color: #000000; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif; font-size: 18px; text-align: center; white-space: pre-wrap; width: 550px;" src="../Images/3aa7c2e006a3dafec5f726b7ded853a6.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?w=1080&amp;ssl=1 1080w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?resize=251%2C300&amp;ssl=1 251w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?resize=857%2C1024&amp;ssl=1 857w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?resize=768%2C917&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?resize=720%2C860&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.42.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-44acc66 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="44acc66" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-6209303 ot-flex-column-vertical" data-id="6209303" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-5f4a5af elementor-widget elementor-widget-text-editor" data-id="5f4a5af" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">该系统无法获得完整数据集的图表，因此我们只能获得500.000个观察值的图表。有趣的方面是，在M1和M2中，已经编码的特征(col_0到col_7)干涉轻微，线条几乎是直的(可能因为是二元变量)；另一方面，在M3和M4有更多的可变性，但是编码特征(0到99)太多了，很难分辨哪个音轨名称最有影响。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} -->T3】</p>
<p class="has-text-align-justify translated">为了更好地理解决策图，让我们只考虑一个观察。下图显示了不同要素值对单个选定预测的影响，以及它们对模型的正面或负面影响。在我们的案例中，我们总是在不同的模型中绘制相同的观察结果(宋):</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-a0d2362 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="a0d2362" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-6af447c ot-flex-column-vertical" data-id="6af447c" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-cfa09c0 elementor-widget elementor-widget-text-editor" data-id="cfa09c0" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31797" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-41-16" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?fit=1078%2C1280&amp;ssl=1" data-orig-size="1078,1280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.41.16" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?fit=253%2C300&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?fit=862%2C1024&amp;ssl=1" decoding="async" loading="lazy" width="1078" height="1280" class="wp-image-31797 aligncenter" style="width: 550px;" src="../Images/1881f6f630cbca38939750c2ca642ce2.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?w=1078&amp;ssl=1 1078w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?resize=253%2C300&amp;ssl=1 253w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?resize=862%2C1024&amp;ssl=1 862w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?resize=768%2C912&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?resize=720%2C855&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.41.16.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-8adeca0 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="8adeca0" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-568b1c1 ot-flex-column-vertical" data-id="568b1c1" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-99f4608 elementor-widget elementor-widget-text-editor" data-id="99f4608" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">例如，在第一个图表中，我们可以看到第3个月、第3个工作日、第16天、col_3 True、Artists 45.981对模型有正面影响，而其他功能有负面影响。</p>
<p class="has-text-align-justify translated">有趣的是，同一个特征值对最终模型输出的影响不同；此外，使用完整数据集，我们获得的模型输出值大于使用子集时的值(M2为4.79，M1为0.19，M4为3.52，M3为0.09)。区别是实质性的:原因可能是删除一些观察值会降低相同观察值的重要性。</p>
<h6 class="translated">力图</h6>
<h6 class="translated"><!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:heading {"level":4} --> <!-- /wp:heading --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --></h6>
<p class="has-text-align-justify translated">这个图给了我们一个<strong>局部可解释性</strong>，显示了单次观察的SHAP值。为了简单起见，让我们采用与上面相同的观察结果，并且只显示一个代表M1的力图:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-68f2ea3 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="68f2ea3" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-5fe5a6b ot-flex-column-vertical" data-id="5fe5a6b" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-5d3106d elementor-widget elementor-widget-text-editor" data-id="5d3106d" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31764" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/force_plot_0_new" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?fit=1674%2C362&amp;ssl=1" data-orig-size="1674,362" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="force_plot_0_new" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?fit=300%2C65&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?fit=1024%2C221&amp;ssl=1" decoding="async" loading="lazy" width="1674" height="362" class="wp-image-31764 aligncenter" style="width: 700px;" src="../Images/592725cf292ce4f9ff69857aa0470fad.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?w=1674&amp;ssl=1 1674w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?resize=300%2C65&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?resize=1024%2C221&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?resize=768%2C166&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?resize=1536%2C332&amp;ssl=1 1536w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?resize=720%2C156&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/force_plot_0_new.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-bed03de ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="bed03de" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-3b2690a ot-flex-column-vertical" data-id="3b2690a" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-1ad53f3 elementor-widget elementor-widget-text-editor" data-id="1ad53f3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">从这个图中，你可以看到:</p>
<ul>
<li style="list-style-type: none;">
 
<ul>
<li class="translated"><strong> f(x) </strong>是模型预测值(0.19)</li>
<li class="translated"><strong>基值</strong>，即如果我们不知道当前输出的任何特性时预测的值</li>
<li class="translated">每个要素对输出的影响方式和程度:将预测值推高的要素显示为红色，将预测值推低的要素显示为蓝色。“艺术家”是45.9809(即Luis Fonsi)的事实产生了积极影响，而“流”是27748的事实产生了消极影响。</li>
</ul>
</li>
</ul>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:list --> <!-- /wp:list --> <!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify translated">现在应该考虑4个不同的观察值，并检查其模型的输出值。回答特定查询(例如<strong> query_ID = 0 </strong>对应于<strong> Ecuador </strong>地区)的这些歌曲的SHAP得分在下表中被报告和排序:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-57d28f9 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="57d28f9" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-1260916 ot-flex-column-vertical" data-id="1260916" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-4b4a141 elementor-widget elementor-widget-text-editor" data-id="4b4a141" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31765" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-09-30-49" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?fit=952%2C298&amp;ssl=1" data-orig-size="952,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 09.30.49" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?fit=300%2C94&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?fit=952%2C298&amp;ssl=1" decoding="async" loading="lazy" width="952" height="298" class="wp-image-31765 aligncenter" style="width: 500px;" src="../Images/48255fe6d9247a6fc20fcd4daa7c1785.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?w=952&amp;ssl=1 952w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?resize=300%2C94&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?resize=768%2C240&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?resize=720%2C225&amp;ssl=1 720w" sizes="(max-width: 952px) 100vw, 952px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-09.30.49.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-01b2e12 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="01b2e12" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-1cbc81c ot-flex-column-vertical" data-id="1cbc81c" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-6a70fee elementor-widget elementor-widget-text-editor" data-id="6a70fee" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">该模型的输出不是相关性标签，但是如果我们观察歌曲之间的SHAP分数的相对相关性，它代表相同的概念。由于0.19 &gt; -4.42 &gt; -4.96 &gt; -9.02，使用SHAP分数或相关性标签，结果的排序将是等同的。</p>
<h6 class="translated">依赖图</h6>
<h6 class="translated"><!-- wp:paragraph {"align":"justify"} -->T2<!-- wp:heading {"level":4} -->T4<!-- wp:paragraph {"align":"justify"} -->T6】</h6>
<p class="has-text-align-justify translated">依赖图<a href="https://web.archive.org/web/20221202222543/https://slundberg.github.io/shap/notebooks/plots/dependence_plot.html">【5】</a>显示了两个特征对模型预测结果的边际影响。作为第一个例子，我报告了流和艺术家之间的依赖图:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-08c400b ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="08c400b" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-86286d9 ot-flex-column-vertical" data-id="86286d9" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-6eccefc elementor-widget elementor-widget-text-editor" data-id="6eccefc" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31798" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-42-42" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?fit=1082%2C438&amp;ssl=1" data-orig-size="1082,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.42.42" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?fit=300%2C121&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?fit=1024%2C415&amp;ssl=1" decoding="async" loading="lazy" width="1082" height="438" class="wp-image-31798 aligncenter" style="width: 600px;" src="../Images/394afc16737862036b97126e80612418.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?w=1082&amp;ssl=1 1082w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?resize=300%2C121&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?resize=1024%2C415&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?resize=768%2C311&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?resize=720%2C291&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.42.42.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-cef5d83 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="cef5d83" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-548ed0c ot-flex-column-vertical" data-id="548ed0c" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-10beb71 elementor-widget elementor-widget-text-editor" data-id="10beb71" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">这里每个点对应一个预测；在x轴上，我们有流值，在y轴上，我们有预测的SHAP值，颜色代表艺术家。我们可以看到一个很奇怪的情况:在流数很低的情况下，每个艺人真的会有所作为；反之亦然，在某个阈值之后，每个艺术家以相同的方式影响，并且SHAP值是高的和恒定的。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} -->T3】</p>
<p class="has-text-align-justify translated">作为第二个例子，我使用相同的特征报告了依赖图，但是在轴上颠倒了它们:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-fd8851f ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="fd8851f" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-55c8398 ot-flex-column-vertical" data-id="55c8398" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-2b48bf0 elementor-widget elementor-widget-text-editor" data-id="2b48bf0" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31799" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-40-43" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?fit=1080%2C466&amp;ssl=1" data-orig-size="1080,466" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.40.43" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?fit=300%2C129&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?fit=1024%2C442&amp;ssl=1" decoding="async" loading="lazy" width="1080" height="466" class="wp-image-31799 aligncenter" style="width: 600px;" src="../Images/84a42233e19ef6b5e74fae532ea7c39b.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?w=1080&amp;ssl=1 1080w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?resize=300%2C129&amp;ssl=1 300w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?resize=1024%2C442&amp;ssl=1 1024w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?resize=768%2C331&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?resize=720%2C311&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.43.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-ccbcfb2 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="ccbcfb2" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-f43a4a6 ot-flex-column-vertical" data-id="f43a4a6" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-6f64e4a elementor-widget elementor-widget-text-editor" data-id="6f64e4a" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">即使在这种情况下，我们也能注意到“艺术家”造成了差异:艺术家的价值观&lt; 50 (plus or minus) produce higher SHAP values than the others. As mentioned above, the ‘Artists’ feature has been encoded with a technique based on the mean of the target variable values (Position on chart) so the Artists who are known to always be in the highest positions are also those who have the lowest encoding values (so the average of the Position values &lt; 50). This result suggests that Artists who have the same relevance, also have the same impact on the model; therefore the most popular Artists positively affect the model’s output.<mark class="has-inline-color" style="background-color: rgba(0, 0, 0, 0); color: #a3001b;"> </mark></p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} -->T3<!-- wp:paragraph {"align":"justify"} -->T5】</p>
<p class="has-text-align-justify translated">我们还可以为图表的日期创建这种绘图，也就是说，分别为日、月和工作日功能创建这种绘图，并根据流的数量给点着色:</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-b6b68f0 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="b6b68f0" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-4bd4e71 ot-flex-column-vertical" data-id="4bd4e71" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-5699095 elementor-widget elementor-widget-text-editor" data-id="5699095" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated"><img data-attachment-id="31800" data-permalink="https://web.archive.org/web/20221202222543/https://sease.io/2021/02/a-learning-to-rank-project-on-a-daily-song-ranking-problem-part-2.html/schermata-2021-01-14-alle-13-40-19" data-orig-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?fit=1082%2C1176&amp;ssl=1" data-orig-size="1082,1176" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schermata 2021-01-14 alle 13.40.19" data-image-description="" data-image-caption="" data-medium-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?fit=276%2C300&amp;ssl=1" data-large-file="https://web.archive.org/web/20221202222543/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?fit=942%2C1024&amp;ssl=1" decoding="async" loading="lazy" width="1082" height="1176" class="wp-image-31800 aligncenter" style="width: 600px;" src="../Images/14738109baca862ba13563cbbb081841.png" alt="" data-recalc-dims="1" srcset="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?w=1082&amp;ssl=1 1082w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?resize=276%2C300&amp;ssl=1 276w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?resize=942%2C1024&amp;ssl=1 942w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?resize=768%2C835&amp;ssl=1 768w, https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?resize=720%2C783&amp;ssl=1 720w" sizes="(max-width: 1000px) 100vw, 1000px" data-original-src="https://web.archive.org/web/20221202222543im_/https://i0.wp.com/sease.io/wp-content/uploads/2021/12/Schermata-2021-01-14-alle-13.40.19.png?ssl=1"/></p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-306e3ac ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="306e3ac" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-42f9cea ot-flex-column-vertical" data-id="42f9cea" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-4528726 elementor-widget elementor-widget-text-editor" data-id="4528726" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="has-text-align-justify translated">在这种情况下，我们可以立即看到，日和工作日对完整数据集中的模型输出没有影响(这反映了汇总图的结果)。只有某些日子的流量比其他日子多(例如星期天)。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --> <!-- wp:paragraph {"align":"justify"} --> <!-- /wp:paragraph --></p>
<p class="has-text-align-justify translated">在子集中，不考虑流，我们可以注意到前半个月、前半年和前半周比后半周产生更大的SHAP值，这意味着对输出的积极影响。无论如何，没有额外的信息，很难解释这种类型的行为。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-0ff7376 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="0ff7376" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-ab018db ot-flex-column-vertical" data-id="ab018db" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-af0e0b4 elementor-widget elementor-widget-iheading" data-id="af0e0b4" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h6 class="main-heading translated">摘要</h6>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-cbf42d0 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="cbf42d0" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-66377d6 ot-flex-column-vertical" data-id="66377d6" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-71c867b elementor-widget elementor-widget-text-editor" data-id="71c867b" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">让我们在一个每日歌曲排名问题上回顾一下学习排名项目的要点。</p>
<p class="translated"><!-- wp:paragraph {"align":"justify"} --><!-- /wp:paragraph --><!-- wp:paragraph {"align":"justify"} -->T3】</p>
<p class="translated">在第一篇博文中，我们展示了从可用数据开始，创建和操作训练集和测试集，然后使用开源库训练排名模型，建立和构建学习排名(LTR)系统的管道。在第二篇博文中，我们通过处理数据进行了进一步的分析，以寻找见解，并通过使用SHAP图书馆对模型的行为进行了解释。所有获得的结果都是在Kaggle<a href="https://web.archive.org/web/20221202222543/https://www.kaggle.com/edumucelli/spotifys-worldwide-daily-song-ranking/home">【6】</a>上关于全球每日歌曲排名的Spotify数据集上计算的。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-11ce35a ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="11ce35a" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-2ffe3b5 ot-flex-column-vertical" data-id="2ffe3b5" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-33d4881 elementor-widget elementor-widget-iheading" data-id="33d4881" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h6 class="main-heading translated">外卖食品</h6>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-2e203f7 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="2e203f7" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-5a0f135 ot-flex-column-vertical" data-id="5a0f135" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-c439c96 elementor-widget elementor-widget-text-editor" data-id="c439c96" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<ul>
<li style="list-style-type: none;">
 
<ul id="block-deff4dba-5f1c-4e75-a0b5-fab473b15ab5" tabindex="0" role="document" aria-multiline="true" aria-label="Block: List" data-block="deff4dba-5f1c-4e75-a0b5-fab473b15ab5" data-type="core/list" data-title="List">
<li class="translated">数据预处理和特征工程是至关重要的，也是我们应该更加重视的部分</li>
<li class="translated">当我们有一个更大的数据集时，Doc2vec编码技术在模型性能上似乎比哈希编码更好</li>
<li class="translated">较小的数据集可变性较小，可能更容易理解，但代表性较差</li>
<li class="translated">评估ndcg@10值可能大于训练ndcg@10值</li>
<li class="translated">特别是在某些领域，存在一个阈值，超过这个阈值，增加测试集的大小不会带来任何改进</li>
<li class="translated">在不训练任何模型的情况下，我们可以通过直接排序(降序或升序)特定特征的值来获得结果的良好排序</li>
<li class="translated">SHAP图书馆是解释这一特性重要性的有力工具。一些图表向我们展示了许多见解，有助于理解每个变量如何影响模型的输出；然而，如果不了解我们工作的背景，就不容易给出详尽的解释。</li>
</ul>
</li>
</ul>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-b5715e3 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="b5715e3" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-e41f82d ot-flex-column-vertical" data-id="e41f82d" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-51bbfe0 elementor-widget elementor-widget-iheading" data-id="51bbfe0" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        <h6 class="main-heading translated">未来作品</h6>	    </div>
	    		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-1c541dc ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="1c541dc" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-d73532c ot-flex-column-vertical" data-id="d73532c" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-535a5b3 elementor-widget elementor-widget-text-editor" data-id="535a5b3" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">到目前为止，我们只从Region列生成了“query_ID ”,而没有考虑歌曲排行榜的日期。在这篇博文第二部分描述的分析过程中，我们意识到我们可以把它看作是多个查询级别特性的散列，以避免每个查询的歌曲“重复”。在下一篇博文中，我们将创建query_ID作为多个变量(地区、日期、月份和工作日)的散列，我们将再次对获得的模型进行比较。</p>
<p/>
<p class="translated">我希望这两篇博客文章很有趣，并且你已经学会了处理LTR任务和进行相关调查所需的工具。</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-89b1866 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="89b1866" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-34f5e58 ot-flex-column-vertical" data-id="34f5e58" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-9ba1044 elementor-widget elementor-widget-iheading" data-id="9ba1044" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        	            <span>// our service</span>
	        <h2 class="main-heading translated">不要脸的塞给我们培训和服务！</h2>	    </div>
	    		</div>
				</div>
				<div class="elementor-element elementor-element-d4b6fef elementor-widget elementor-widget-text-editor" data-id="d4b6fef" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">我提到过我们做<a href="https://web.archive.org/web/20221202222543/https://sease.io/learning-to-rank-training">学习排名</a>和<a href="https://web.archive.org/web/20221202222543/https://sease.io/training/search-relevance-training/search-relevance-training-solr">搜索相关性</a>培训吗？<br/>我们也提供这些主题的咨询，<a href="https://web.archive.org/web/20221202222543/https://sease.io/contacts">如果你想让你的搜索引擎更上一层楼，请联系</a>！</p>					</div>
						</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-60fbe32 ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="60fbe32" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-77baf2a ot-flex-column-vertical" data-id="77baf2a" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-b86fc55 elementor-widget elementor-widget-iheading" data-id="b86fc55" data-element_type="widget" data-widget_type="iheading.default">
				<div class="elementor-widget-container">
					<div class="ot-heading">
	        	            <span>// STAY ALWAYS UP TO DATE</span>
	        <h2 class="main-heading translated">订阅我们的时事通讯</h2>	    </div>
	    		</div>
				</div>
				<div class="elementor-element elementor-element-ff51fa6 elementor-widget elementor-widget-text-editor" data-id="ff51fa6" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
								<div class="elementor-text-editor elementor-clearfix">
				<p class="translated">你喜欢这个帖子吗？这个帖子是关于一个关于每日歌曲排名问题的学习排名项目。不要忘记订阅我们的时事通讯，以便随时了解信息检索世界的最新动态！</p>					</div>
						</div>
				</div>
				<div class="elementor-element elementor-element-c5dbb10 elementor-widget elementor-widget-wp-widget-mc4wp_form_widget" data-id="c5dbb10" data-element_type="widget" data-widget_type="wp-widget-mc4wp_form_widget.default">
				<div class="elementor-widget-container">
			<script>(function() {
	window.mc4wp = window.mc4wp || {
		listeners: [],
		forms: {
			on: function(evt, cb) {
				window.mc4wp.listeners.push(
					{
						event   : evt,
						callback: cb
					}
				);
			}
		}
	}
})();
</script><!-- Mailchimp for WordPress v4.8.11 - https://wordpress.org/plugins/mailchimp-for-wp/ --><form id="mc4wp-form-1" class="mc4wp-form mc4wp-form-1343" method="post" data-id="1343" data-name="Sease Mailchimp"><div class="mc4wp-form-fields">
<div class="subscribe-inner-form">
	<input type="email" name="EMAIL" placeholder="Your Email" required=""/>
	<button type="submit" class="subscribe-btn-icon"><i class="flaticon-telegram"/></button>
</div>	

<p class="translated"><label> <input name="AGREE_TO_TERMS" type="checkbox" value="1" required=""/> <a href="https://web.archive.org/web/20221202222543/https://sease.io/privacy-policy" target="_blank">我已经阅读并同意隐私政策</a> </label></p></div><label style="display: none !important;">Leave this field empty if you're human: <input type="text" name="_mc4wp_honeypot" value="" tabindex="-1" autocomplete="off"/></label><input type="hidden" name="_mc4wp_timestamp" value="1670019943"/><input type="hidden" name="_mc4wp_form_id" value="1343"/><input type="hidden" name="_mc4wp_form_element_id" value="mc4wp-form-1"/><div class="mc4wp-response"/></form><!-- / Mailchimp for WordPress Plugin -->		</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
									    
</body>
</html>